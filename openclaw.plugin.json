{
  "id": "tool-guard",
  "name": "Tool Guard",
  "description": "Prevents malformed tool call loops with dedup detection, hard caps, and model attribution logging",
  "version": "1.0.0",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "maxIdenticalFailures": {
        "type": "number",
        "description": "Max identical tool call failures before loop break",
        "default": 2
      },
      "maxFailuresPerTurn": {
        "type": "number",
        "description": "Max total tool failures per turn before hard stop",
        "default": 5
      },
      "logPath": {
        "type": "string",
        "description": "Path for attribution log file (JSON lines)",
        "default": "~/.openclaw/tool-guard.log"
      },
      "enabled": {
        "type": "boolean",
        "default": true
      },
      "metrics": {
        "type": "object",
        "description": "Token usage metrics collection and dashboard",
        "properties": {
          "enabled": { "type": "boolean", "default": true, "description": "Enable metrics collection" },
          "gatewayId": { "type": "string", "description": "Override gateway identifier (defaults to agent name)" },
          "dbPath": { "type": "string", "default": "~/.openclaw/metrics.db", "description": "SQLite database path" },
          "dashboard": {
            "type": "object",
            "properties": {
              "enabled": { "type": "boolean", "default": true },
              "port": { "type": "number", "default": 8080 },
              "bind": { "type": "string", "default": "127.0.0.1" }
            }
          },
          "retention": {
            "type": "object",
            "properties": {
              "rawDays": { "type": "number", "default": 30 },
              "hourlyDays": { "type": "number", "default": 90 },
              "dailyDays": { "type": "number", "default": 365 }
            }
          },
          "buffer": {
            "type": "object",
            "properties": {
              "flushMs": { "type": "number", "default": 5000 },
              "flushSize": { "type": "number", "default": 100 }
            }
          }
        }
      }
    }
  },
  "uiHints": {
    "maxIdenticalFailures": { "label": "Max Identical Failures", "placeholder": "2" },
    "maxFailuresPerTurn": { "label": "Max Failures Per Turn", "placeholder": "5" },
    "logPath": { "label": "Log File Path" }
  }
}
